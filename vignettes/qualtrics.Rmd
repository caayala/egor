---
title: "Setting up and analysing an ego-centered network survey with Qualtrics and egor"
authors: Joy Losee, Till Krenz
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Setting up and analysing an ego-centered network survey with Qualtrics and egor}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

As researchers increasingly opt for online data collection for social network projects, they may find programming the survey and downloading the data from that survey challenging. So, we've developed the following tutorial to make that process between data collection and data analysis more seamless. Feedback welcome, please open an issue on github or [send a mail](mailto:jlosee1@udayton.edu).

## Structure of an ego-centered network survey

1. **Ego Attribute Section.** Include questions about the ego (e.g., demographics, personality inventory, etc.).
2. **Name generator: Alter List.** Participants will list their alters in this section. This section can be customized with slots for as many or as few alters as you would like. The template currently has slots for 5 alters. If you increase the number of alters requested here, you will need to increase the alter attribute and alter-alter tie questions to match. Alter names listed in this section should be piped into the questions in the alter attribute section and the alter-alter tie section.
3. **Name interpretator: Alter Attributes.** The template pipes the names provided in the alter list to the alter attribute questions. This section can be customized to change the number of questions about each alter and to change the wording and response style of each question. Like a standard surveyâ€”all other Qualtrics programming should work for the alter attribute questions. 
Each set of alter attribute questions is separated into a block labeled for that alter (e.g., Alter 1 Attributes, Alter 2 Attributes). If you require more than 5 alters, you will need add as many blocks of alter attribute questions as alters listed (e.g., 10 alters listed would need 10 blocks of alter attribute questions). 
4. **Alter-Alter Tie.** In this section, participants generate information on the alter-alter ties. The template has 10 alter-alter tie questions because the template asks for 5 alters. If you request more than 5 alters, you will need to add the corresponding number of questions to this section (e.g., requesting 30 alters means asking 435 alter-alter tie questions). These questions pipe in the names from the alter list using the same coding at the piping in the alter attribute section.

## Best practices

When coducting ego-centered network surveys some practices have proven to decrease 
drop-out rates and increase the quality of the collected data. Some of the items
listed below apply to any kind of survey, while others are specific to ego-centered
network data collection.

1. **Informed Consent**
2. **Quality assurance**: ask participants to commit to providing their best answers.
3. **Thoroughly describe the data collection process.** Make sure the participant is aware ahead of time how long the process could take and that there is no need to provide identifying information (unless you do plan to match alters across egos in your study or there is some other reason identifying information is necessary). If identifying alter information is necessary, make sure to explain up front what you will do with that information. 
The template has slots for 5 alters, but can expand to any number of alters. 
4. Make sure that alter-alter questions are in the right order.
 
## Create Ego Survey from template

Please download a minimal example of an ego-centered network survey [here](linklinklink). After importing this into Qualtrics you can build upon it, to create your own survey.

## How does it work

![](vis_wizzard.PNG)

Here would be a description of the logic behind it all.

- Use Variables to collect alter names and reference them in following questions
- Mention validation logic and explain for
  - fixed choice (all alters need to be named)
  - (limited) free choice (participants can give as many names as they want up to a limit of x)

## Downloading the data and importing it with `egor`

1. Download data from qualtrics in the CSV format. (add screenshots of the download process?)
2. Import data into R as an `egor` object with the code below.

```
df <- read.csv(file = "filename.csv") # Replace file name with full data set name!
df <- as.data.frame(df)
names(df)

# Create egoID
df$egoID <- 1:nrow(df)

library(egor)

e1 <- onefile_to_egor(egos = df,
                attr.start.col = "A1Gender", # Name of Variable with the first alter attribute
                attr.end.col = "A30_7", # Name of variable with last alter attribute
                max.alters = 30, # Number of maximum alters that were named by participants
                aa.first.var = "AP1") # Name of first alter-alter variable
```

3. Inspect `egor` object.

```
e1
summary(e1)
```

5. Start analysis. Take a look at `using_egor` to learn how to visualize and analyze ego-centered network data with `egor`. 
